function loadVimeoVideo(){var a=$("#video_loading").data("section"),b=$("#video_loading").data("course"),c=$("#video_loading").data("course-id"),d=$("#video_loading").data("video"),e=$("#video_loading").data("playback-rate"),f=$("#video_loading").data("quality"),g=$("#video_loading").data("gnarus-name"),h="/course/"+b+"/section/"+a+"/loadVideos?videoNumber="+d;$.get(h,function(b){attachVideoSources(b,a,c,e,f,g),$("#video-player-frame").bind("contextmenu",function(){return!1})}).fail(showErrorAndExplanationButton)}function attachVideoSources(a,b,c,d,e,f){var g=$('<video id="video-player-frame" class="video-js vjs-default-skin video-player-frame video-player" controls preload="auto" poster="/images/video/vinheta-'+f+'.png"></video>');$.each(a,function(){var a=$('<source type="video/mp4">');a.attr("src",this.link),a.attr("data-res",this.quality),g.append(a)}),$("#loading").remove(),$("#video_loading").append(g),prepareVimeoVideo(c,b,d,e)}function showErrorAndExplanationButton(){$("#error_message").show(),$("#video-player-frame, .tools.clearfix").remove(),$("#button-exercise").text("Ver Explicação");var a=$("#button-exercise").attr("href");$("#button-exercise").attr("href",a.replace("activities","explanation"))}function changeToVimeoIFramePlayer(){var a=$(this).data("uri"),b=$('<iframe class="video-js vjs-tech" webkitAllowFullScreen mozallowfullscreen allowFullScreen> </iframe>');b.attr("src",a+"?api=1");var c=$(".video-js");c.html(b),$(".uiSectionVideo-change_player").hide(),$(".video-options-separator").hide()}function prepareVimeoVideo(a,b,c,d){function e(){var a=this.playbackRate();$.post("/user/profile/setPlaybackRate",{rate:a}),ga("send","event",{eventCategory:f,eventAction:"ratechange",eventLabel:g,eventValue:a,nonInteraction:!0})}var f="course-video",g="course-"+a+" section-"+b;HDtoggle("video-player-frame",d),videojs("video-player-frame",{playbackRates:[.7,.8,1,1.2,1.5,2],plugins:{HD:{},ga:{eventCategory:f,eventLabel:g}}},function(){this.ga(),this.on("ratechange",e),this.on("ended",onVideoFinished)}).ready(function(){this.playbackRate(c)})}function shouldBeLoadedAsynchronously(){return $("#video_loading").length}function isExercisePage(){return $(".exerciseContent").length>0}function onVideoFinished(){trackVideo("finished")}function trackVideo(a){var b=$("#video_loading"),c={"course.id":b.data("course-id"),"section.id":b.data("section"),"movie.id":b.data("video-id")};$.post("/tracking/video/"+a,c)}$(document).ready(function(){if(shouldBeLoadedAsynchronously())loadVimeoVideo();else{var a=$("#video-player-frame").data("section"),b=$("#video-player-frame").data("course"),c=$("#video-player-frame").data("playback-rate"),d=$("#video-player-frame").data("quality");prepareVimeoVideo(b,a,c,d)}$(".uiSectionVideo-change_player").on("click",changeToVimeoIFramePlayer)}),$(window).keypress(function(a){if(32==a.which&&!isExercisePage()){a.preventDefault();var b=document.querySelector("video");1==b.paused?b.play():b.pause()}});